
from simple_salesforce import Salesforce
import requests
import pandas as pd
import csv
from io import StringIO
# Sign into Salesforce
sf = Salesforce(username='mamta.chaudhary@veriforce.com', 
password='Mickle@1004',
security_token='gxVOZWZd4oCbjZm0u3sNLziDk')
# Set report details
sf_org = 'https://pecsafety.lightning.force.com/'
report_id = '00O5W000000W6VvUAK'
export_params = '?isdtp=p1&export=1&enc=UTF-8&xf=csv'
# Download report
sf_report_url = sf_org + report_id + export_params
response = requests.get(sf_report_url, headers=sf.headers, cookies={'sid': sf.session_id})
new_report = response.content.decode('utf-8')
report_df = pd.read_csv(StringIO(new_report))
